<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<post>
  <author>caner</author>
  <title>Store Procedure if / else Kullanımı</title>
  <description>Store Procedure'ler veri tabanı kullanılan projelerin olmazsa olmazıdır.Bunun en &amp;ouml;nemli nedeni </description>
  <content>&lt;p&gt;&lt;span style="font-size: medium;"&gt;Store Procedure'ler veri tabanı kullanılan projelerin olmazsa olmazıdır.Bunun en &amp;ouml;nemli nedeni &lt;strong&gt;G&amp;uuml;venlik&lt;/strong&gt; ve &lt;strong&gt;Hız&lt;/strong&gt; dır. Ado.net kullanılanılarak veri &lt;strong&gt;insert, update, delete&lt;/strong&gt; işlemleri yapılan bir uygulamada Store Procedure değilde direkt olarak &lt;strong&gt;SqlCommand&lt;/strong&gt; nesnesine "insert,update,delete" gibi query'ler yazmak pek &amp;ouml;nerilen bir yol değildir. Nedeni de yine az &amp;ouml;nce s&amp;ouml;ylediğim gibi &amp;ouml;ncelikle hız, g&amp;uuml;venliktir ve yazdığın kodun ne kadar profesyonelce yazıldığıyla ilişkilidir. &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="font-size: medium;"&gt;Store Procedure'lerde &lt;strong&gt;IF ELSE&lt;/strong&gt; kullanabildiğiniz vakit emin olun uygulama tarafında yazdığınız &lt;strong&gt;C#&lt;/strong&gt; kodları &lt;strong&gt;%30&lt;/strong&gt;'lara kadar azalacaktır. &amp;Ouml;rnek olarak verecek olursak; database'de kayıtlı &lt;strong&gt;Users&lt;/strong&gt; adında bir tablom var ve bu tablo&lt;strong&gt; Ad, Soyad, Email&lt;/strong&gt; bilgilerini alarak kullanıcıları kaydediyor olsun. Store Procedure kullanarak bu kullanıcıları database'e kaydeden bir uygulama geliştirecek olduğumuzda, &lt;strong&gt;UserInsert&lt;/strong&gt; ve &amp;nbsp;&lt;strong&gt;UserUpdate&lt;/strong&gt; işlemlerini yapan 2 adet Store Procedure ihtiyacımız var diyelim. Aslında&lt;strong&gt; IF ELSE&lt;/strong&gt; kullanarak bunu bir Store Procedure ile yapmak hem daha hızlı, hemde C# tarafında bizi &amp;ccedil;ok daha fazla kod yazmaktan kurtarıyor.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style="text-decoration: underline; font-size: medium;"&gt;&lt;strong&gt;Users Tablosu &amp;Ouml;rneği;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="font-family: 'Courier New'; color: blue;"&gt;CREATE&lt;/span&gt;&lt;span style="font-family: 'Courier New';"&gt; &lt;span style="color: blue;"&gt;PROCEDURE&lt;/span&gt; InsertUser &amp;nbsp; &lt;span style="color: #339966;"&gt;//Procedure İsmi&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; @Ad &lt;span style="font-family: 'Courier New';"&gt;varchar&lt;/span&gt;&lt;span style="font-family: 'Courier New';"&gt;(&lt;/span&gt;20&lt;span style="font-family: 'Courier New';"&gt;), &amp;nbsp; &lt;span style="color: #339966;"&gt;//aldığı atrib&amp;uuml;t'ler&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; @Soyad &lt;span style="color: blue;"&gt;varchar&lt;/span&gt;&lt;span style="color: gray;"&gt;(&lt;/span&gt;20&lt;span style="color: gray;"&gt;),&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; @Email &lt;span style="color: blue;"&gt;varchar&lt;/span&gt;&lt;span style="color: gray;"&gt;(&lt;/span&gt;20&lt;span style="color: gray;"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New'; color: blue;"&gt;AS&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New'; color: blue;"&gt;BEGIN&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="font-family: 'Courier New';"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;span style="color: #0000ff;"&gt;DECLARE&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: 'Courier New';"&gt;@HasExist &lt;span style="font-family: 'Courier New';"&gt;int&amp;nbsp;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: 'Courier New';"&gt;&amp;nbsp;&lt;/span&gt;&lt;span style="font-family: 'Courier New'; color: #339966;"&gt;//Email adresine g&amp;ouml;re o kullanıcı daha &amp;ouml;nce kayıt olmuş mu diye kontol etmemizi sağlayacak olan değişken&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;Select&lt;/span&gt; @HasExist &lt;span style="color: gray;"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: fuchsia;"&gt;COUNT&lt;/span&gt;&lt;span style="color: gray;"&gt;(&lt;/span&gt;1&lt;span style="color: gray;"&gt;)&lt;/span&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;from&lt;/span&gt; Users&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="font-family: 'Courier New';"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff; font-family: 'Courier New';"&gt;Where&amp;nbsp;&lt;/span&gt;&lt;span style="font-family: 'Courier New';"&gt;Email&lt;span style="font-family: 'Courier New';"&gt;=&lt;/span&gt;@Email &amp;nbsp; &lt;span style="color: #339966;"&gt;//Bu email adresi kayıtlı mı diye bakıyoruz&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="font-family: 'Courier New'; color: blue;"&gt;IF&lt;/span&gt;&lt;span style="font-family: 'Courier New'; color: gray;"&gt;(&lt;/span&gt;&lt;span style="font-family: 'Courier New';"&gt;@HasExist&lt;span style="color: gray;"&gt;=&lt;/span&gt;0&lt;span style="color: gray;"&gt;) &lt;span style="color: #339966;"&gt;//&amp;Uuml;stteki sorgudan d&amp;ouml;nen değer @HsExist değişkenine atanıyor ve eğer o kayıt var ise "0" dan farklı bir değer yok ise "0" değerini d&amp;ouml;n&amp;uuml;yor, "0" d&amp;ouml;nd&amp;uuml;ğ&amp;uuml;nde yeni bir kayıt ekleyeceğimizi anlıyoruz ve aşağıda olduğu gibi Procedure'e parametre olarak gelen değerleri alıp tabloya yeni bir User ekliyoruz&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New'; color: blue;"&gt;BEGIN&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;Insert&lt;/span&gt; &lt;span style="color: blue;"&gt;Into&lt;/span&gt; Users &amp;nbsp;&lt;span style="color: #339966;"&gt; //Insert işlemi&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;values&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="font-family: 'Courier New'; color: blue;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/span&gt;&lt;span style="font-family: 'Courier New'; color: gray;"&gt;(&lt;/span&gt;&lt;span style="font-family: 'Courier New';"&gt;@Ad&lt;span style="color: gray;"&gt;,&lt;/span&gt;@Soyad&lt;span style="color: gray;"&gt;,&lt;/span&gt;@Email&lt;span style="color: gray;"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New'; color: blue;"&gt;END&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New'; color: blue;"&gt;ELSE &amp;nbsp;&lt;span style="color: #339966;"&gt;//Eğer @HasExist "0" a eşit değilse bu demek oluyorki bu kullanıcı database'de kayıtlı bulunmakta, bu seferde Procedure'e parametre olarak gelen değerleri alarak o kullanıcının bilgilerini aşağıda olduğu gibi Update ediyoruz&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New'; color: blue;"&gt;BEGIN&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;Update&lt;/span&gt; Users &amp;nbsp; &lt;span style="color: #339966;"&gt;//Update işlemi&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;span style="color: blue;"&gt;set&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Ad&lt;span style="color: gray;"&gt; =&lt;/span&gt;@ Ad&lt;span style="color: gray;"&gt;, &amp;nbsp;&lt;span style="color: #339966;"&gt;//bilgileri update ediyoruz&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Soyad&lt;span style="color: gray;"&gt;=&lt;/span&gt;@Soyad&lt;span style="color: gray;"&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New';"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Email&lt;span style="color: gray;"&gt;=&lt;/span&gt;@Email&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium;"&gt;&lt;span style="font-family: 'Courier New';"&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000ff; font-family: 'Courier New';"&gt;WHERE&amp;nbsp;&lt;/span&gt;&lt;span style="font-family: 'Courier New';"&gt;Email&lt;span style="font-family: 'Courier New';"&gt;=&lt;/span&gt;@Email &amp;nbsp;&lt;span style="color: #339966;"&gt;//where koşulu O kullanıcıyı bulmamızı sağlıyor&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New'; color: blue;"&gt;END&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&lt;span style="font-size: medium; font-family: 'Courier New'; color: blue;"&gt;END&lt;/span&gt;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&amp;nbsp;&lt;/p&gt;
&lt;p class="MsoNormal" style="margin-bottom: 0.0001pt;"&gt;&amp;nbsp;&lt;/p&gt;</content>
  <ispublished>True</ispublished>
  <isdeleted>False</isdeleted>
  <iscommentsenabled>True</iscommentsenabled>
  <pubDate>2013-06-04 20:45:00</pubDate>
  <lastModified>2020-01-20 08:22:34</lastModified>
  <raters>0</raters>
  <rating>0</rating>
  <slug>Store-Procedure-if-else-Kullanımı</slug>
  <tags>
    <tag>store procedure</tag>
    <tag>procedure</tag>
    <tag>sql</tag>
    <tag>ifelse</tag>
  </tags>
  <comments />
  <categories>
    <category>33191729-e344-4de6-8ecf-6400c88b07e7</category>
  </categories>
  <notifications />
</post>